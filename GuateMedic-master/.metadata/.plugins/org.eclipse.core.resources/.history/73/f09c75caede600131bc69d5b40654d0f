package com.example.guatemedic;

import java.io.IOException;
import java.util.Map;

import org.apache.http.HttpResponse;
import org.apache.http.client.ClientProtocolException;
import org.apache.http.client.HttpClient;
import org.apache.http.client.methods.HttpPost;
import org.apache.http.entity.StringEntity;
import org.apache.http.impl.client.DefaultHttpClient;
import org.apache.http.util.EntityUtils;

import android.util.Log;

public class HttpPostRequest {
	public String postUrl(String urlSpec, Map<String, String> headerMap, String jsonBody) throws IOException {
		HttpClient httpclient = new DefaultHttpClient();
		HttpPost httppost = new HttpPost(urlSpec);
		
		try {
		    // Add header stuff
			if (headerMap != null) {
			    for (String key : headerMap.keySet()) {
			    	httppost.addHeader(key, headerMap.get(key));
			    }
			}
		    if (jsonBody != null) {
			    StringEntity sEntity = new StringEntity(jsonBody, "UTF-8");
			    httppost.setEntity(sEntity);
		    }
		    // Execute HTTP Post Request
		    HttpResponse response = httpclient.execute(httppost);
		    if (response.getStatusLine().getStatusCode() != 200) {
		    	return null;
		    }
		    
		    return EntityUtils.toString(response.getEntity());
		    

		} catch (ClientProtocolException e) {
		    // TODO Auto-generated catch block
			Log.i("WTF", e.getMessage());
		} catch (IOException e) {
		    // TODO Auto-generated catch block
			Log.i("WTF", e.getMessage());
		}
		return null;
	}
	
}